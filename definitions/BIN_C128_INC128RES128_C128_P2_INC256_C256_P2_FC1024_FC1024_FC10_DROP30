DATA TOP data DIM1 128 DIM2 3 DIM3 32 DIM4 32
DATA TOP labels DIM1 128 DIM2 1 DIM3 1 DIM4 1

CONV TOP conv0 IN data K_SIZE 3 CHANNELS 32 PAD 1
BNORM TOP conv0
RELU TOP conv0

BNORM_TOP TOP inc0-branch0-bn0 IN conv0
SIGN TOP inc0-branch0-signum0 IN inc0-branch0-bn0
DROP TOP inc0-branch0-signum0 RATIO 0.3
BINCONV TOP inc0-branch0-conv0 IN inc0-branch0-signum0 K_SIZE 5 CHANNELS 16 PAD 2
BIN_RES_POOL_BLOCK TOP inc0-branch0-res0 IN inc0-branch0-conv0 RATIO 0.3 POOL_K_SIZE 3 POOL_STRIDE 2 K_SIZE 5 CHANNELS1 16 CHANNELS2 16 PAD 2
BNORM TOP inc0-branch0-res0
SIGN TOP inc0-branch0-signum1 IN inc0-branch0-res0

BNORM_TOP TOP inc0-branch1-bn0 IN conv0
SIGN TOP inc0-branch1-signum0 IN inc0-branch1-bn0
DROP TOP inc0-branch1-signum0 RATIO 0.3
BINCONV TOP inc0-branch1-conv0 IN inc0-branch1-signum0 K_SIZE 3 CHANNELS 32 PAD 1
BIN_RES_POOL_BLOCK TOP inc0-branch1-res0 IN inc0-branch1-conv0 RATIO 0.3 POOL_K_SIZE 3 POOL_STRIDE 2 K_SIZE 3 CHANNELS1 32 CHANNELS2 32 PAD 1
BNORM TOP inc0-branch1-res0
SIGN TOP inc0-branch1-signum1 IN inc0-branch1-res0

BNORM_TOP TOP inc0-branch2-bn0 IN conv0
SIGN TOP inc0-branch2-signum0 IN inc0-branch2-bn0
DROP TOP inc0-branch2-signum0 RATIO 0.3
BINCONV TOP inc0-branch2-conv0 IN inc0-branch2-signum0 K_SIZE 1 CHANNELS 128 PAD 0
BIN_RES_POOL_BLOCK TOP inc0-branch2-res0 IN inc0-branch2-conv0 RATIO 0.3 POOL_K_SIZE 3 POOL_STRIDE 2 K_SIZE 1 CHANNELS1 128 CHANNELS2 128 PAD 0
BNORM TOP inc0-branch2-res0
SIGN TOP inc0-branch2-signum1 IN inc0-branch2-res0

CONCAT3 TOP inc0 IN1 inc0-branch0-signum1 IN2 inc0-branch1-signum1 IN3 inc0-branch2-signum1
DROP TOP inc0 RATIO 0.3
BINCONV TOP conv1 IN inc0 K_SIZE 3 CHANNELS 128 PAD 1
POOL TOP pool0 IN conv1 K_SIZE 3 STRIDE 2

BIN_INC_BLOCK TOP inc1 IN pool0 RATIO 0.3 K_SIZE0 5 K_SIZE1 3 K_SIZE2 1 CHANNELS0 32 CHANNELS1 64 CHANNELS2 256 PAD0 2 PAD1 1 PAD2 0
DROP TOP inc1 RATIO 0.3
BINCONV TOP conv2 IN inc1 K_SIZE 3 CHANNELS 256 PAD 1
POOL TOP pool1 IN conv2 K_SIZE 3 STRIDE 2
RESHAPE TOP reshape IN pool1 DIM1 0 DIM2 -1 DIM3 1 DIM4 1

BNORM TOP reshape
SIGN TOP signum0 IN reshape
DROP TOP signum0 RATIO 0.3
BINCONV TOP conv3 IN signum0 K_SIZE 1 CHANNELS 1024

BNORM TOP conv3
SIGN TOP signum1 IN conv3
DROP TOP signum1 RATIO 0.3
BINCONV TOP conv4 IN signum1 K_SIZE 1 CHANNELS 1024

BNORM TOP conv4
RELU TOP conv4
DROP TOP conv4 RATIO 0.3
CONV TOP conv5 IN conv4 K_SIZE 1 CHANNELS 10

ACCURACY TOP acc IN1 conv5 IN2 labels
SOFTMAXLOSS TOP loss IN1 conv5 IN2 labels
