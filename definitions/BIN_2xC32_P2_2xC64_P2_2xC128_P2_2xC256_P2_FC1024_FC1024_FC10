DATA TOP data DIM1 128 DIM2 3 DIM3 32 DIM4 32
DATA TOP labels DIM1 128 DIM2 1 DIM3 1 DIM4 1

CONV TOP conv0 IN data K_SIZE 3 CHANNELS 32 PAD 1
BNORM TOP conv0
RELU TOP conv0

BNORM_TOP TOP 2conv0-bn IN conv0
SIGN TOP signum-1 IN 2conv0-bn
BINCONV TOP 2conv0 IN signum-1 K_SIZE 3 CHANNELS 32 PAD 1

POOL TOP pool0 IN 2conv0 K_SIZE 3 STRIDE 2

BNORM TOP pool0 
SIGN TOP signum0 IN pool0
BINCONV TOP conv1 IN signum0 K_SIZE 3 CHANNELS 64 PAD 1

BNORM TOP conv1 
SIGN TOP 2signum0 IN conv1
BINCONV TOP 2conv1 IN 2signum0 K_SIZE 3 CHANNELS 64 PAD 1

POOL TOP pool1 IN 2conv1 K_SIZE 3 STRIDE 2

BNORM TOP pool1
SIGN TOP signum1 IN pool1
BINCONV TOP conv2 IN signum1 K_SIZE 3 CHANNELS 128 PAD 1

BNORM TOP conv2
SIGN TOP 2signum1 IN conv2
BINCONV TOP 2conv2 IN 2signum1 K_SIZE 3 CHANNELS 128 PAD 1

POOL TOP pool2 IN 2conv2 K_SIZE 3 STRIDE 2

BNORM TOP pool2
SIGN TOP signum2 IN pool2
BINCONV TOP conv3 IN signum2 K_SIZE 3 CHANNELS 256 PAD 1

BNORM TOP conv3
SIGN TOP 2signum2 IN conv3
BINCONV TOP 2conv3 IN 2signum2 K_SIZE 3 CHANNELS 256 PAD 1

POOL TOP pool3 IN 2conv3 K_SIZE 3 STRIDE 2

RESHAPE TOP reshape IN pool3 DIM1 0 DIM2 -1 DIM3 1 DIM4 1

BNORM TOP reshape
SIGN TOP signum3 IN reshape
BINCONV TOP conv4 IN signum3 K_SIZE 1 CHANNELS 256

BNORM TOP conv4
SIGN TOP signum4 IN conv4
DROP TOP signum4 
BINCONV TOP conv5 IN signum4 K_SIZE 1 CHANNELS 256

BNORM TOP conv5 
RELU TOP conv5
DROP TOP conv5
CONV TOP conv6 IN conv5 K_SIZE 1 CHANNELS 10

ACCURACY TOP acc IN1 conv6 IN2 labels
SOFTMAXLOSS TOP loss IN1 conv6 IN2 labels


