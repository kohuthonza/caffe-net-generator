DATA TOP data DIM1 128 DIM2 3 DIM3 32 DIM4 32
DATA TOP labels DIM1 128 DIM2 1 DIM3 1 DIM4 1

CONV TOP conv0 IN data K_SIZE 3 CHANNELS 128 PAD 1
BNORM TOP conv0 IN conv0
RELU TOP conv0

BIN_RES_BLOCK TOP res0 IN conv0 K_SIZE 3 CHANNELS1 128 CHANNELS2 128 PAD 1 RATIO 0.3
BIN_RES_POOL_BLOCK TOP res1 IN res0 POOL_K_SIZE 3 K_SIZE 3 POOL_STRIDE 2 CHANNELS1 128 CHANNELS2 128 PAD 1 RATIO 0.3

BIN_RES_BLOCK TOP res2 IN res1 K_SIZE 3 CHANNELS1 128 CHANNELS2 128 PAD 1 RATIO 0.3
BIN_RES_POOL_BLOCK TOP res3 IN res2 POOL_K_SIZE 3 K_SIZE 3 POOL_STRIDE 2 CHANNELS1 128 CHANNELS2 128 PAD 1 RATIO 0.3

BIN_RES_BLOCK TOP res4 IN res3 K_SIZE 3 CHANNELS1 128 CHANNELS2 128 PAD 1 RATIO 0.3
BIN_RES_POOL_BLOCK TOP res5 IN res4 POOL_K_SIZE 3 K_SIZE 3 POOL_STRIDE 2 CHANNELS1 128 CHANNELS2 128 PAD 1 RATIO 0.3

RESHAPE TOP reshape IN res5 DIM1 0 DIM2 -1 DIM3 1 DIM4 1

BNORM TOP reshape
SIGN TOP signum0 IN reshape
DROP TOP signum0 RATIO 0.3
BINCONV TOP conv1 IN signum0 K_SIZE 1 CHANNELS 1024

BNORM TOP conv1
SIGN TOP signum1 IN conv1
DROP TOP signum1 RATIO 0.3
BINCONV TOP conv2 IN signum1 K_SIZE 1 CHANNELS 1024

BNORM TOP conv2
RELU TOP conv2
DROP TOP conv2 RATIO 0.3
CONV TOP conv3 IN conv2 K_SIZE 1 CHANNELS 10

ACCURACY TOP acc IN1 conv3 IN2 labels
SOFTMAXLOSS TOP loss IN1 conv3 IN2 labels

 
